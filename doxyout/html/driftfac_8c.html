<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GADGET-2: driftfac.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>driftfac.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>compute loop-up tables for prefactors in cosmological integration  
<a href="#_details">More...</a></p>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;mpi.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_math.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_integration.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="allvars_8h_source.html">allvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="proto_8h_source.html">proto.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for driftfac.c:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c__incl.png" border="0" usemap="#driftfac_8c" alt=""/></div>
<map name="driftfac_8c" id="driftfac_8c">
<area shape="rect" id="node17" href="allvars_8h.html" title="declares global variables." alt="" coords="666,160,741,189"/><area shape="rect" id="node24" href="proto_8h.html" title="this file contains all function prototypes of the code" alt="" coords="751,83,818,112"/><area shape="rect" id="node22" href="tags_8h.html" title="declares various tags for labelling MPI messages." alt="" coords="726,237,787,267"/></map>
</div>

<p><a href="driftfac_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a2adb5d14857fdbea8ba352245450e52a">WORKSIZE</a>&nbsp;&nbsp;&nbsp;100000</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#aea1f81063199abb9d89802b444098018">init_drift_table</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#adadb384299eb936596574417d4b6b28c">get_drift_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a29057b821b850ab54b318d7339633059">get_gravkick_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#ace65dca1556185b12c7f22427724c90c">get_hydrokick_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a8cb77fa18fd6b91a358bd0a9c04cbf2e">drift_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a2eafe05fb12d7f9d954d5b501e186051">gravkick_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a5ebdee2c7332bed6c1a8994ac3c38c0d">hydrokick_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a9690d42f31f3e278745a9e19b5a0ec6f">growthfactor_integ</a> (double a, void *param)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>compute loop-up tables for prefactors in cosmological integration </p>

<p>Definition in file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a2adb5d14857fdbea8ba352245450e52a"></a><!-- doxytag: member="driftfac.c::WORKSIZE" ref="a2adb5d14857fdbea8ba352245450e52a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WORKSIZE&nbsp;&nbsp;&nbsp;100000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8cb77fa18fd6b91a358bd0a9c04cbf2e"></a><!-- doxytag: member="driftfac.c::drift_integ" ref="a8cb77fa18fd6b91a358bd0a9c04cbf2e" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double drift_integ </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for drift factor computation. </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00179">179</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00338">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h_source.html#l00339">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h_source.html#l00340">global_data_all_processes::OmegaLambda</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a6e6a37250907d90a56f92a55aefdda5f">Hubble</a> * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * a * a * a);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="adadb384299eb936596574417d4b6b28c"></a><!-- doxytag: member="driftfac.c::get_drift_factor" ref="adadb384299eb936596574417d4b6b28c" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_drift_factor </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a drift step between time0 and time1. The value returned is * </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{a_0}^{a_1} \frac{{\rm d}a}{H(a)} * \]" src="form_3.png"/>
</p>
 
<p><p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>
</p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00067">67</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00111">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c_source.html#l00098">DriftTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>, and <a class="el" href="allvars_8h_source.html#l00377">global_data_all_processes::Timebase_interval</a>.</p>

<p>Referenced by <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i1 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a074db1ef4adfe88a5f3b07eac8c1daae">DriftTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = DriftTable[i1 - 1] + (DriftTable[i1] - DriftTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i2 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * DriftTable[0];
  <span class="keywordflow">else</span>
    df2 = DriftTable[i2 - 1] + (DriftTable[i2] - DriftTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph.png" border="0" usemap="#driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph" alt=""/></div>
<map name="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph" id="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="175,5,292,35"/><area shape="rect" id="node5" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="341,5,560,35"/><area shape="rect" id="node7" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="608,5,651,35"/><area shape="rect" id="node9" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="700,5,753,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a29057b821b850ab54b318d7339633059"></a><!-- doxytag: member="driftfac.c::get_gravkick_factor" ref="a29057b821b850ab54b318d7339633059" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_gravkick_factor </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a kick step of the gravitational force. </p>

<p><p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>
</p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00105">105</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00111">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c_source.html#l00099">GravKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>, and <a class="el" href="allvars_8h_source.html#l00377">global_data_all_processes::Timebase_interval</a>.</p>

<p>Referenced by <a class="el" href="timestep_8c_source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c_source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c_source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i1 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a38e5d8b595161f074f7fbede3a8fda66">GravKickTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = GravKickTable[i1 - 1] + (GravKickTable[i1] - GravKickTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i2 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * GravKickTable[0];
  <span class="keywordflow">else</span>
    df2 = GravKickTable[i2 - 1] + (GravKickTable[i2] - GravKickTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph.png" border="0" usemap="#driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph" alt=""/></div>
<map name="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph" id="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph">
<area shape="rect" id="node3" href="timestep_8c.html#a05e5a546d63684b55d2457aa56efdd06" title="advance_and_find_timesteps" alt="" coords="683,5,891,35"/><area shape="rect" id="node9" href="proto_8h.html#ada58109949c2431ca9b0cdaa01cfb5b1" title="compute_global_quantities_of_system" alt="" coords="368,57,635,87"/><area shape="rect" id="node14" href="proto_8h.html#aea8fa222a10c4796687c6ff25550cd74" title="fill_write_buffer" alt="" coords="203,109,317,139"/><area shape="rect" id="node24" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="201,163,319,192"/><area shape="rect" id="node5" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="1205,84,1248,113"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1297,84,1351,113"/><area shape="rect" id="node11" href="run_8c.html#ae903322da17c6875ab606b032b918099" title="energy_statistics" alt="" coords="983,57,1113,87"/><area shape="rect" id="node16" href="proto_8h.html#a48b0ed3a843924501df8ed871e08e77c" title="write_file" alt="" coords="463,111,540,140"/><area shape="rect" id="node18" href="proto_8h.html#a523730833804b6d92aa7f4dd474805c5" title="savepositions" alt="" coords="732,111,841,140"/><area shape="rect" id="node20" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="939,161,1157,191"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace65dca1556185b12c7f22427724c90c"></a><!-- doxytag: member="driftfac.c::get_hydrokick_factor" ref="ace65dca1556185b12c7f22427724c90c" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_hydrokick_factor </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>time1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a kick step of the hydrodynamical force. </p>

<p><p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>
</p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00142">142</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00111">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c_source.html#l00100">HydroKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>, and <a class="el" href="allvars_8h_source.html#l00377">global_data_all_processes::Timebase_interval</a>.</p>

<p>Referenced by <a class="el" href="timestep_8c_source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c_source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c_source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a0dd4962a455bb955f04ec271d7af7bb4">Timebase_interval</a>;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i1 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a274a5737d1578d54d6f82130e3064771">HydroKickTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = HydroKickTable[i1 - 1] + (HydroKickTable[i1] - HydroKickTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a>)
    i2 = <a class="code" href="allvars_8h.html#aec9dcf4def3489f6890e20e7d66151c6">DRIFT_TABLE_LENGTH</a> - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * HydroKickTable[0];
  <span class="keywordflow">else</span>
    df2 = HydroKickTable[i2 - 1] + (HydroKickTable[i2] - HydroKickTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph.png" border="0" usemap="#driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph" alt=""/></div>
<map name="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph" id="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph">
<area shape="rect" id="node3" href="timestep_8c.html#a05e5a546d63684b55d2457aa56efdd06" title="advance_and_find_timesteps" alt="" coords="691,5,899,35"/><area shape="rect" id="node9" href="proto_8h.html#ada58109949c2431ca9b0cdaa01cfb5b1" title="compute_global_quantities_of_system" alt="" coords="376,57,643,87"/><area shape="rect" id="node14" href="proto_8h.html#aea8fa222a10c4796687c6ff25550cd74" title="fill_write_buffer" alt="" coords="211,109,325,139"/><area shape="rect" id="node24" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="209,163,327,192"/><area shape="rect" id="node5" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="1213,84,1256,113"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1305,84,1359,113"/><area shape="rect" id="node11" href="run_8c.html#ae903322da17c6875ab606b032b918099" title="energy_statistics" alt="" coords="991,57,1121,87"/><area shape="rect" id="node16" href="proto_8h.html#a48b0ed3a843924501df8ed871e08e77c" title="write_file" alt="" coords="471,111,548,140"/><area shape="rect" id="node18" href="proto_8h.html#a523730833804b6d92aa7f4dd474805c5" title="savepositions" alt="" coords="740,111,849,140"/><area shape="rect" id="node20" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="947,161,1165,191"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2eafe05fb12d7f9d954d5b501e186051"></a><!-- doxytag: member="driftfac.c::gravkick_integ" ref="a2eafe05fb12d7f9d954d5b501e186051" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gravkick_integ </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for gravitational kick factor computation. </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00191">191</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00338">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h_source.html#l00339">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h_source.html#l00340">global_data_all_processes::OmegaLambda</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a6e6a37250907d90a56f92a55aefdda5f">Hubble</a> * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * a * a);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9690d42f31f3e278745a9e19b5a0ec6f"></a><!-- doxytag: member="driftfac.c::growthfactor_integ" ref="a9690d42f31f3e278745a9e19b5a0ec6f" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double growthfactor_integ </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00214">214</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00339">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h_source.html#l00340">global_data_all_processes::OmegaLambda</a>, and <a class="el" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> s;

  s = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>) * a + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a> * a * a * a;
  s = sqrt(s);

  <span class="keywordflow">return</span> <a class="code" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(sqrt(a) / s, 3);
}
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph.png" border="0" usemap="#driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph" alt=""/></div>
<map name="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph" id="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph">
<area shape="rect" id="node3" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e" title="pow" alt="" coords="196,5,241,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5ebdee2c7332bed6c1a8994ac3c38c0d"></a><!-- doxytag: member="driftfac.c::hydrokick_integ" ref="a5ebdee2c7332bed6c1a8994ac3c38c0d" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double hydrokick_integ </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for hydrodynamical kick factor computation. </p>

<p><p>&lt; adiabatic index of simulated gas </p>
</p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00204">204</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8h_source.html#l00071">GAMMA_MINUS1</a>, <a class="el" href="allvars_8h_source.html#l00338">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h_source.html#l00339">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h_source.html#l00340">global_data_all_processes::OmegaLambda</a>, and <a class="el" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#abac5eca1b5851e670eec01d4dd47c417">Omega0</a> - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ae272abeafbcb16230374a903a3e4e298">OmegaLambda</a>;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a6e6a37250907d90a56f92a55aefdda5f">Hubble</a> * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * <a class="code" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(a, 3 * <a class="code" href="allvars_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>) * a);
}
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph.png" border="0" usemap="#driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph" alt=""/></div>
<map name="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph" id="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph">
<area shape="rect" id="node3" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e" title="pow" alt="" coords="177,5,223,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aea1f81063199abb9d89802b444098018"></a><!-- doxytag: member="driftfac.c::init_drift_table" ref="aea1f81063199abb9d89802b444098018" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_drift_table </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function computes look-up tables for factors needed in cosmological integrations. The (simple) integrations are carried out with the GSL library. Separate factors are computed for the "drift", and the gravitational and hydrodynamical "kicks". The lookup-table is used for reasons of speed. </p>

<p><p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>
</p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00026">26</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8c_source.html#l00098">DriftTable</a>, <a class="el" href="allvars_8c_source.html#l00099">GravKickTable</a>, <a class="el" href="allvars_8c_source.html#l00100">HydroKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>, <a class="el" href="allvars_8h_source.html#l00370">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h_source.html#l00372">global_data_all_processes::TimeMax</a>, <a class="el" href="driftfac_8c.html#a2adb5d14857fdbea8ba352245450e52a">WORKSIZE</a>, and <a class="el" href="pm__periodic_8c_source.html#l00045">workspace</a>.</p>

<p>Referenced by <a class="el" href="begrun_8c_source.html#l00028">begrun()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define WORKSIZE 100000</span>
<span class="preprocessor"></span>  <span class="keywordtype">int</span> i;
  <span class="keywordtype">double</span> result, abserr;
  gsl_function F;
  gsl_integration_workspace *<a class="code" href="pm__periodic_8c.html#a182a8913bc59d672bb2a85e63ffcde0f">workspace</a>;

  <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> = log(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ad671e0af15abea094631b996dc78c8f1">TimeBegin</a>);
  <a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> = log(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a3e22fbc2ce177c1e383e9acbbf44f8d5">TimeMax</a>);

  workspace = gsl_integration_workspace_alloc(WORKSIZE);

  <span class="keywordflow">for</span>(i = 0; i &lt; DRIFT_TABLE_LENGTH; i++)
    {
      F.function = &amp;drift_integ;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a074db1ef4adfe88a5f3b07eac8c1daae">DriftTable</a>[i] = result;


      F.function = &amp;gravkick_integ;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a38e5d8b595161f074f7fbede3a8fda66">GravKickTable</a>[i] = result;


      F.function = &amp;hydrokick_integ;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a274a5737d1578d54d6f82130e3064771">HydroKickTable</a>[i] = result;
    }

  gsl_integration_workspace_free(workspace);
}
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph.png" border="0" usemap="#driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph" alt=""/></div>
<map name="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph" id="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#aceeb5c8909331b90ea8345e0fc853f82" title="begrun" alt="" coords="165,5,232,35"/><area shape="rect" id="node5" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="281,5,335,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="adf1795a43a5fd6de0a14b805094dac47"></a><!-- doxytag: member="driftfac.c::logTimeBegin" ref="adf1795a43a5fd6de0a14b805094dac47" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00016">16</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00067">get_drift_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00142">get_hydrokick_factor()</a>, and <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e08a12787034f570c56ff664de37e2a"></a><!-- doxytag: member="driftfac.c::logTimeMax" ref="a0e08a12787034f570c56ff664de37e2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00017">17</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00067">get_drift_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00142">get_hydrokick_factor()</a>, and <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Dec 3 2010 18:45:43 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
