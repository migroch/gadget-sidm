<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>gadget-sidm: driftfac.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">gadget-sidm
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('driftfac_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">driftfac.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>compute loop-up tables for prefactors in cosmological integration  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;mpi.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_math.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_integration.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="allvars_8h_source.html">allvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="proto_8h_source.html">proto.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for driftfac.c:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c__incl.png" border="0" usemap="#driftfac_8c" alt=""/></div>
<map name="driftfac_8c" id="driftfac_8c">
<area shape="rect" id="node17" href="allvars_8h.html" title="declares global variables." alt="" coords="666,161,741,189"/><area shape="rect" id="node24" href="proto_8h.html" title="this file contains all function prototypes of the code" alt="" coords="751,83,818,111"/><area shape="rect" id="node22" href="tags_8h.html" title="declares various tags for labelling MPI messages." alt="" coords="726,238,787,266"/></map>
</div>
</div>
<p><a href="driftfac_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a2adb5d14857fdbea8ba352245450e52a">WORKSIZE</a>&#160;&#160;&#160;100000</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#aea1f81063199abb9d89802b444098018">init_drift_table</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#adadb384299eb936596574417d4b6b28c">get_drift_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a29057b821b850ab54b318d7339633059">get_gravkick_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#ace65dca1556185b12c7f22427724c90c">get_hydrokick_factor</a> (int time0, int time1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a8cb77fa18fd6b91a358bd0a9c04cbf2e">drift_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a2eafe05fb12d7f9d954d5b501e186051">gravkick_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a5ebdee2c7332bed6c1a8994ac3c38c0d">hydrokick_integ</a> (double a, void *param)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a9690d42f31f3e278745a9e19b5a0ec6f">growthfactor_integ</a> (double a, void *param)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>compute loop-up tables for prefactors in cosmological integration </p>

<p>Definition in file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a2adb5d14857fdbea8ba352245450e52a"></a><!-- doxytag: member="driftfac.c::WORKSIZE" ref="a2adb5d14857fdbea8ba352245450e52a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="driftfac_8c.html#a2adb5d14857fdbea8ba352245450e52a">WORKSIZE</a>&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8cb77fa18fd6b91a358bd0a9c04cbf2e"></a><!-- doxytag: member="driftfac.c::drift_integ" ref="a8cb77fa18fd6b91a358bd0a9c04cbf2e" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#a8cb77fa18fd6b91a358bd0a9c04cbf2e">drift_integ</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for drift factor computation. </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00179">179</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Hubble * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * a * a * a);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a8cb77fa18fd6b91a358bd0a9c04cbf2e_icgraph.png" border="0" usemap="#driftfac_8c_a8cb77fa18fd6b91a358bd0a9c04cbf2e_icgraph" alt=""/></div>
<map name="driftfac_8c_a8cb77fa18fd6b91a358bd0a9c04cbf2e_icgraph" id="driftfac_8c_a8cb77fa18fd6b91a358bd0a9c04cbf2e_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#aea1f81063199abb9d89802b444098018" title="init_drift_table" alt="" coords="141,5,253,33"/><area shape="rect" id="node5" href="proto_8h.html#aceeb5c8909331b90ea8345e0fc853f82" title="begrun" alt="" coords="301,5,368,33"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="417,5,471,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adadb384299eb936596574417d4b6b28c"></a><!-- doxytag: member="driftfac.c::get_drift_factor" ref="adadb384299eb936596574417d4b6b28c" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#adadb384299eb936596574417d4b6b28c">get_drift_factor</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a drift step between time0 and time1. The value returned is * </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{a_0}^{a_1} \frac{{\rm d}a}{H(a)} * \]" src="form_0.png"/>
</p>
 <p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00067">67</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8c_source.html#l00098">DriftTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, and <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>.</p>

<p>Referenced by <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= DRIFT_TABLE_LENGTH)
    i1 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a074db1ef4adfe88a5f3b07eac8c1daae">DriftTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = DriftTable[i1 - 1] + (DriftTable[i1] - DriftTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= DRIFT_TABLE_LENGTH)
    i2 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * DriftTable[0];
  <span class="keywordflow">else</span>
    df2 = DriftTable[i2 - 1] + (DriftTable[i2] - DriftTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph.png" border="0" usemap="#driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph" alt=""/></div>
<map name="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph" id="driftfac_8c_adadb384299eb936596574417d4b6b28c_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="175,5,292,33"/><area shape="rect" id="node5" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="341,5,560,33"/><area shape="rect" id="node7" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="608,5,651,33"/><area shape="rect" id="node9" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="700,5,753,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a29057b821b850ab54b318d7339633059"></a><!-- doxytag: member="driftfac.c::get_gravkick_factor" ref="a29057b821b850ab54b318d7339633059" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#a29057b821b850ab54b318d7339633059">get_gravkick_factor</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a kick step of the gravitational force. </p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00105">105</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8c_source.html#l00099">GravKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, and <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>.</p>

<p>Referenced by <a class="el" href="timestep_8c_source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c_source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c_source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= DRIFT_TABLE_LENGTH)
    i1 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a38e5d8b595161f074f7fbede3a8fda66">GravKickTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = GravKickTable[i1 - 1] + (GravKickTable[i1] - GravKickTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= DRIFT_TABLE_LENGTH)
    i2 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * GravKickTable[0];
  <span class="keywordflow">else</span>
    df2 = GravKickTable[i2 - 1] + (GravKickTable[i2] - GravKickTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph.png" border="0" usemap="#driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph" alt=""/></div>
<map name="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph" id="driftfac_8c_a29057b821b850ab54b318d7339633059_icgraph">
<area shape="rect" id="node3" href="timestep_8c.html#a05e5a546d63684b55d2457aa56efdd06" title="advance_and_find_timesteps" alt="" coords="683,5,891,33"/><area shape="rect" id="node9" href="proto_8h.html#ada58109949c2431ca9b0cdaa01cfb5b1" title="compute_global_quantities_of_system" alt="" coords="368,55,635,83"/><area shape="rect" id="node14" href="proto_8h.html#aea8fa222a10c4796687c6ff25550cd74" title="fill_write_buffer" alt="" coords="203,106,317,134"/><area shape="rect" id="node24" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="201,157,319,185"/><area shape="rect" id="node5" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="1205,81,1248,109"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1297,81,1351,109"/><area shape="rect" id="node11" href="run_8c.html#ae903322da17c6875ab606b032b918099" title="energy_statistics" alt="" coords="983,55,1113,83"/><area shape="rect" id="node16" href="proto_8h.html#a48b0ed3a843924501df8ed871e08e77c" title="write_file" alt="" coords="463,106,540,134"/><area shape="rect" id="node18" href="proto_8h.html#a523730833804b6d92aa7f4dd474805c5" title="savepositions" alt="" coords="732,106,841,134"/><area shape="rect" id="node21" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="939,157,1157,185"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace65dca1556185b12c7f22427724c90c"></a><!-- doxytag: member="driftfac.c::get_hydrokick_factor" ref="ace65dca1556185b12c7f22427724c90c" args="(int time0, int time1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#ace65dca1556185b12c7f22427724c90c">get_hydrokick_factor</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function integrates the cosmological prefactor for a kick step of the hydrodynamical force. </p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00142">142</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="allvars_8c_source.html#l00100">HydroKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, and <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>.</p>

<p>Referenced by <a class="el" href="timestep_8c_source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c_source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c_source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c_source.html#l00031">move_particles()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> a1, a2, df1, df2, u1, u2;
  <span class="keywordtype">int</span> i1, i2;

  <span class="comment">/* note: will only be called for cosmological integration */</span>

  a1 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time0 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;
  a2 = <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + time1 * <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Timebase_interval;

  u1 = (a1 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i1 = (int) u1;
  <span class="keywordflow">if</span>(i1 &gt;= DRIFT_TABLE_LENGTH)
    i1 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i1 &lt;= 1)
    df1 = u1 * <a class="code" href="allvars_8c.html#a274a5737d1578d54d6f82130e3064771">HydroKickTable</a>[0];
  <span class="keywordflow">else</span>
    df1 = HydroKickTable[i1 - 1] + (HydroKickTable[i1] - HydroKickTable[i1 - 1]) * (u1 - i1);


  u2 = (a2 - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / (<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) * DRIFT_TABLE_LENGTH;
  i2 = (int) u2;
  <span class="keywordflow">if</span>(i2 &gt;= DRIFT_TABLE_LENGTH)
    i2 = DRIFT_TABLE_LENGTH - 1;

  <span class="keywordflow">if</span>(i2 &lt;= 1)
    df2 = u2 * HydroKickTable[0];
  <span class="keywordflow">else</span>
    df2 = HydroKickTable[i2 - 1] + (HydroKickTable[i2] - HydroKickTable[i2 - 1]) * (u2 - i2);

  <span class="keywordflow">return</span> df2 - df1;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph.png" border="0" usemap="#driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph" alt=""/></div>
<map name="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph" id="driftfac_8c_ace65dca1556185b12c7f22427724c90c_icgraph">
<area shape="rect" id="node3" href="timestep_8c.html#a05e5a546d63684b55d2457aa56efdd06" title="advance_and_find_timesteps" alt="" coords="691,5,899,33"/><area shape="rect" id="node9" href="proto_8h.html#ada58109949c2431ca9b0cdaa01cfb5b1" title="compute_global_quantities_of_system" alt="" coords="376,55,643,83"/><area shape="rect" id="node14" href="proto_8h.html#aea8fa222a10c4796687c6ff25550cd74" title="fill_write_buffer" alt="" coords="211,106,325,134"/><area shape="rect" id="node24" href="proto_8h.html#a02a8a27a7a75ce5cd6c2a27b4d641e31" title="move_particles" alt="" coords="209,157,327,185"/><area shape="rect" id="node5" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2" title="run" alt="" coords="1213,81,1256,109"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1305,81,1359,109"/><area shape="rect" id="node11" href="run_8c.html#ae903322da17c6875ab606b032b918099" title="energy_statistics" alt="" coords="991,55,1121,83"/><area shape="rect" id="node16" href="proto_8h.html#a48b0ed3a843924501df8ed871e08e77c" title="write_file" alt="" coords="471,106,548,134"/><area shape="rect" id="node18" href="proto_8h.html#a523730833804b6d92aa7f4dd474805c5" title="savepositions" alt="" coords="740,106,849,134"/><area shape="rect" id="node21" href="run_8c.html#ad52604af910b3e1677718d863ab09391" title="find_next_sync_point_and_drift" alt="" coords="947,157,1165,185"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2eafe05fb12d7f9d954d5b501e186051"></a><!-- doxytag: member="driftfac.c::gravkick_integ" ref="a2eafe05fb12d7f9d954d5b501e186051" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#a2eafe05fb12d7f9d954d5b501e186051">gravkick_integ</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for gravitational kick factor computation. </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00191">191</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Hubble * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * a * a);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a2eafe05fb12d7f9d954d5b501e186051_icgraph.png" border="0" usemap="#driftfac_8c_a2eafe05fb12d7f9d954d5b501e186051_icgraph" alt=""/></div>
<map name="driftfac_8c_a2eafe05fb12d7f9d954d5b501e186051_icgraph" id="driftfac_8c_a2eafe05fb12d7f9d954d5b501e186051_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#aea1f81063199abb9d89802b444098018" title="init_drift_table" alt="" coords="168,5,280,33"/><area shape="rect" id="node5" href="proto_8h.html#aceeb5c8909331b90ea8345e0fc853f82" title="begrun" alt="" coords="328,5,395,33"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="444,5,497,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9690d42f31f3e278745a9e19b5a0ec6f"></a><!-- doxytag: member="driftfac.c::growthfactor_integ" ref="a9690d42f31f3e278745a9e19b5a0ec6f" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="driftfac_8c.html#a9690d42f31f3e278745a9e19b5a0ec6f">growthfactor_integ</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00214">214</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, and <a class="el" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> s;

  s = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda) * a + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda * a * a * a;
  s = sqrt(s);

  <span class="keywordflow">return</span> <a class="code" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(sqrt(a) / s, 3);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph.png" border="0" usemap="#driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph" alt=""/></div>
<map name="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph" id="driftfac_8c_a9690d42f31f3e278745a9e19b5a0ec6f_cgraph">
<area shape="rect" id="node3" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e" title="pow" alt="" coords="196,5,241,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5ebdee2c7332bed6c1a8994ac3c38c0d"></a><!-- doxytag: member="driftfac.c::hydrokick_integ" ref="a5ebdee2c7332bed6c1a8994ac3c38c0d" args="(double a, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="proto_8h.html#a5ebdee2c7332bed6c1a8994ac3c38c0d">hydrokick_integ</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Integration kernel for hydrodynamical kick factor computation. </p>
<p>&lt; adiabatic index of simulated gas </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00204">204</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, and <a class="el" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow()</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> h;

  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 / (a * a * a) + (1 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Omega0 - <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda) / (a * a) + <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.OmegaLambda;
  h = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.Hubble * sqrt(h);

  <span class="keywordflow">return</span> 1 / (h * <a class="code" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(a, 3 * GAMMA_MINUS1) * a);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph.png" border="0" usemap="#driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph" alt=""/></div>
<map name="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph" id="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_cgraph">
<area shape="rect" id="node3" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e" title="pow" alt="" coords="177,5,223,33"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_icgraph.png" border="0" usemap="#driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_icgraph" alt=""/></div>
<map name="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_icgraph" id="driftfac_8c_a5ebdee2c7332bed6c1a8994ac3c38c0d_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#aea1f81063199abb9d89802b444098018" title="init_drift_table" alt="" coords="176,5,288,33"/><area shape="rect" id="node5" href="proto_8h.html#aceeb5c8909331b90ea8345e0fc853f82" title="begrun" alt="" coords="336,5,403,33"/><area shape="rect" id="node7" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="452,5,505,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aea1f81063199abb9d89802b444098018"></a><!-- doxytag: member="driftfac.c::init_drift_table" ref="aea1f81063199abb9d89802b444098018" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="proto_8h.html#aea1f81063199abb9d89802b444098018">init_drift_table</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function computes look-up tables for factors needed in cosmological integrations. The (simple) integrations are carried out with the GSL library. Separate factors are computed for the "drift", and the gravitational and hydrodynamical "kicks". The lookup-table is used for reasons of speed. </p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors</p>
<p>&lt; length of the lookup table used to hold the drift and kick factors </p>

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00026">26</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>References <a class="el" href="allvars_8c_source.html#l00112">All</a>, <a class="el" href="driftfac_8c_source.html#l00179">drift_integ()</a>, <a class="el" href="allvars_8c_source.html#l00098">DriftTable</a>, <a class="el" href="driftfac_8c_source.html#l00191">gravkick_integ()</a>, <a class="el" href="allvars_8c_source.html#l00099">GravKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00204">hydrokick_integ()</a>, <a class="el" href="allvars_8c_source.html#l00100">HydroKickTable</a>, <a class="el" href="driftfac_8c_source.html#l00016">logTimeBegin</a>, <a class="el" href="driftfac_8c_source.html#l00017">logTimeMax</a>, <a class="el" href="driftfac_8c.html#a2adb5d14857fdbea8ba352245450e52a">WORKSIZE</a>, and <a class="el" href="pm__periodic_8c_source.html#l00045">workspace</a>.</p>

<p>Referenced by <a class="el" href="begrun_8c_source.html#l00028">begrun()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#define WORKSIZE 100000</span>
<span class="preprocessor"></span>  <span class="keywordtype">int</span> i;
  <span class="keywordtype">double</span> result, abserr;
  gsl_function F;
  gsl_integration_workspace *<a class="code" href="pm__periodic_8c.html#a182a8913bc59d672bb2a85e63ffcde0f">workspace</a>;

  <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> = log(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.TimeBegin);
  <a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> = log(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.TimeMax);

  workspace = gsl_integration_workspace_alloc(WORKSIZE);

  <span class="keywordflow">for</span>(i = 0; i &lt; DRIFT_TABLE_LENGTH; i++)
    {
      F.function = &amp;<a class="code" href="driftfac_8c.html#a8cb77fa18fd6b91a358bd0a9c04cbf2e">drift_integ</a>;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a074db1ef4adfe88a5f3b07eac8c1daae">DriftTable</a>[i] = result;


      F.function = &amp;<a class="code" href="driftfac_8c.html#a2eafe05fb12d7f9d954d5b501e186051">gravkick_integ</a>;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a38e5d8b595161f074f7fbede3a8fda66">GravKickTable</a>[i] = result;


      F.function = &amp;<a class="code" href="driftfac_8c.html#a5ebdee2c7332bed6c1a8994ac3c38c0d">hydrokick_integ</a>;
      gsl_integration_qag(&amp;F, exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>), exp(<a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a> + ((<a class="code" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a> - <a class="code" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a>) / DRIFT_TABLE_LENGTH) * (i + 1)), 0,
                          1.0e-8, WORKSIZE, GSL_INTEG_GAUSS41, workspace, &amp;result, &amp;abserr);
      <a class="code" href="allvars_8c.html#a274a5737d1578d54d6f82130e3064771">HydroKickTable</a>[i] = result;
    }

  gsl_integration_workspace_free(workspace);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_aea1f81063199abb9d89802b444098018_cgraph.png" border="0" usemap="#driftfac_8c_aea1f81063199abb9d89802b444098018_cgraph" alt=""/></div>
<map name="driftfac_8c_aea1f81063199abb9d89802b444098018_cgraph" id="driftfac_8c_aea1f81063199abb9d89802b444098018_cgraph">
<area shape="rect" id="node3" href="driftfac_8c.html#a8cb77fa18fd6b91a358bd0a9c04cbf2e" title="drift_integ" alt="" coords="184,5,269,33"/><area shape="rect" id="node5" href="driftfac_8c.html#a2eafe05fb12d7f9d954d5b501e186051" title="gravkick_integ" alt="" coords="171,55,283,83"/><area shape="rect" id="node7" href="driftfac_8c.html#a5ebdee2c7332bed6c1a8994ac3c38c0d" title="hydrokick_integ" alt="" coords="167,106,287,134"/><area shape="rect" id="node9" href="proto_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e" title="pow" alt="" coords="337,106,383,134"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph.png" border="0" usemap="#driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph" alt=""/></div>
<map name="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph" id="driftfac_8c_aea1f81063199abb9d89802b444098018_icgraph">
<area shape="rect" id="node3" href="proto_8h.html#aceeb5c8909331b90ea8345e0fc853f82" title="begrun" alt="" coords="165,5,232,33"/><area shape="rect" id="node5" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="281,5,335,33"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="adf1795a43a5fd6de0a14b805094dac47"></a><!-- doxytag: member="driftfac.c::logTimeBegin" ref="adf1795a43a5fd6de0a14b805094dac47" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="driftfac_8c.html#adf1795a43a5fd6de0a14b805094dac47">logTimeBegin</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00016">16</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00067">get_drift_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00142">get_hydrokick_factor()</a>, and <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e08a12787034f570c56ff664de37e2a"></a><!-- doxytag: member="driftfac.c::logTimeMax" ref="a0e08a12787034f570c56ff664de37e2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="driftfac_8c.html#a0e08a12787034f570c56ff664de37e2a">logTimeMax</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="driftfac_8c_source.html#l00017">17</a> of file <a class="el" href="driftfac_8c_source.html">driftfac.c</a>.</p>

<p>Referenced by <a class="el" href="driftfac_8c_source.html#l00067">get_drift_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c_source.html#l00142">get_hydrokick_factor()</a>, and <a class="el" href="driftfac_8c_source.html#l00026">init_drift_table()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="driftfac_8c.html">driftfac.c</a>      </li>

    <li class="footer">Generated on Fri Dec 6 2013 15:20:10 for gadget-sidm by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
